<html>
 <head>
  <link href="../docs.css" rel="stylesheet" type="text/css" />
 </head>
 <body>
  <h1>Introduction to Webwidgets</h1>
  <p class="intro">This document will guide you through creating your
  first Webwidgets application. It assumes you have already
  successfully installed Webware and Webwidgets (and tested that it
  all works using e.g. Tests/WwmlTest1).</p>

  <p>A webwidgets application is itself a Webware page, and each
  Webware page must reside in some Webware context. So the first step
  of creating a Webwidgets application would be to create a Webware
  context: First create the directory
  <tt>/usr/lib/python2.3/site-packages/HelloWeb</tt>, then add the
  following line to the end of the file
  <tt>/var/www/WebWare/Configs/Application.config</tt>:</p>

  <blockquote><pre>
Contexts['HelloWeb'] = '/usr/lib/python2.3/site-packages/HelloWeb'
  </pre></blockquote>

  <p>Next, we need to add a webware page file, a user interface
  definition file and a callbacks file to the context directory. When
  done, the directory will look thus:<p>

  <blockquote><pre>
/usr/lib/python2.3/site-packages/HelloWeb
/usr/lib/python2.3/site-packages/HelloWeb/__init__.py
/usr/lib/python2.3/site-packages/HelloWeb/index.py #This is the webware page
/usr/lib/python2.3/site-packages/HelloWeb/UI
/usr/lib/python2.3/site-packages/HelloWeb/UI/__init__.wwml
/usr/lib/python2.3/site-packages/HelloWeb/Callbacks
/usr/lib/python2.3/site-packages/HelloWeb/Callbacks/__init__.py
  </pre></blockquote>

  <p>The Webware page index.py is the main entry point of the
  application, and loads the user interface when a new user session is
  opened by a user. Note that Webware requires the Program subclass to
  be named the same as the file (index)</p>

  <blockquote><pre>
#! /bin/env python
# -*- coding: UTF-8 -*-
# vim: set fileencoding=UTF-8 :

import Webwidgets
import HelloWeb.UI

class index(Webwidgets.Program):
    class Session(Webwidgets.Program.Session):
	def newWindow(self, winId):
	    return HelloWeb.UI.MyWindow(self, winId)
  </pre></blockquote>

  <p>The user interface definition is the module named UI above, and
  is expected by the above code to contain a top-level Window subclass
  called MyWindow.</p>

  <p>It is possible to write the user interface definition in pure
  Python which allows for greate flexibility, but is also quite
  verbose and requires lots of boilerplate code, so the code presented
  here uses the <a href="../Wwml/index.html">Wwml</a> language to
  define the user interface. This is a simple XML-based language for
  defining the UI layout (but not the actual look - that's the job of
  <a href="http://www.w3.org/TR/CSS21/">CSS</a>!).</p>

  <p>Not only does Wwml simplify the work to create widgets, it also
  helps separating the layout from the application code, which is
  stored in a separate python module file. In this example, that's the
  HelloWeb.Callbacks module.<p>

  <p>First <tt>UI/__init__.wwml</tt>:</p>
  <blockquote><pre>
&lt;?xml version="1.0"?&gt;
&lt;w:wwml
 xmlns="http://www.w3.org/TR/REC-html40"
 xmlns:w="http://freecode.no/xml/namespaces/wwml-1.0"
 xmlns:html="http://www.w3.org/TR/REC-html40"
 bind="HelloWeb.Callbacks"
 &gt;
 &lt;w:HtmlWindow
  id="MyWindow"
  title="Redback Webwidgets demo application"&gt;

  &lt;w:StyleLink id="head" style="../../Widgets.css" /&gt;

  &lt;w:Html id="body"&gt;
   &lt;div&gt;Please enter some random string below and press "go"&lt;/div&gt;
   &lt;div&gt;
    &lt;w:Html id="res" html="" /&gt;
    &lt;w:StringInput id="str" /&gt;
    &lt;w:Button id="go" title="go" /&gt;
   &lt;/div&gt;
  &lt;/w:Html&gt;
 &lt;/w:HtmlWindow&gt;
&lt;/w:wwml&gt;
  </pre></blockquote>

  <p>Next, the <tt>Callbacks/__init__.py</tt>:</p>
  <blockquote><pre>
# -*- coding: UTF-8 -*-
# vim: set fileencoding=UTF-8 :

class MyWindow(object):
    class body(object):
	class go(object):
	    def clicked(self, path):
		self.parent['res'].html = self.parent['str'].value
  </pre></blockquote>

  <p>Hey, that was a load of XML in that Wwml-file. Actually, quite
  some of it was just boilerplate that needs to be there for it to be
  correct XML and thus Wwml. We'll go though the code line-by line
  now:</p>

  <p>
   <blockquote><pre>
&lt;?xml version="1.0"?&gt;
&lt;w:wwml
 xmlns="http://www.w3.org/TR/REC-html40"
 xmlns:w="http://freecode.no/xml/namespaces/wwml-1.0"
 xmlns:html="http://www.w3.org/TR/REC-html40"
   </pre></blockquote>

   Ok, so that's the boilerplate. This is setting up namespaces for
   Wwml tags and HTML tags, so that they can be freely mixed.

   <blockquote><pre>
 bind="HelloWeb.Callbacks"
 &gt;
   </pre></blockquote>

   This <a href="../Wwml/index.html#callback-binding">binds</a> the
   python module HelloWeb.Callbacks to the widgets in the interface
   definition, so that the callback function (clicked) defined in
   there will be called when the button in the UI is clicked.

   <blockquote><pre>
 &lt;w:HtmlWindow
  id="MyWindow"
  title="Redback Webwidgets demo application"&gt;
   </pre></blockquote>

   This is what creates our main window widget. The tag name is the
   name of an existing widget, either defined in some other Wwml-file
   in the aplication, or one of the predefined ones from the
   Webwidgets package. The id tag is required, and gives the name of
   the widget that gets created. More information on the tag syntax is
   available on the <a
   href="../Wwml/index.html#basic-tag-structure">Wwml manual</a>.

   <blockquote><pre>
  &lt;w:StyleLink id="head" style="../../Widgets.css" /&gt;
   </pre></blockquote>

   This just adds a stylesheet to the head section of the HTML document.

   <blockquote><pre>
  &lt;w:Html id="body"&gt;
   </pre></blockquote>

   Here goes the bulk of the document...

   <blockquote><pre>
   &lt;div&gt;Please enter some random string below and press "go"&lt;/div&gt;
   &lt;div&gt;
    &lt;w:Html id="res" html="" /&gt;
    &lt;w:StringInput id="str" /&gt;
    &lt;w:Button id="go" title="go" /&gt;
   &lt;/div&gt;
  &lt;/w:Html&gt;
 &lt;/w:HtmlWindow&gt;
&lt;/w:wwml&gt;
   </pre></blockquote>
  
  Html code can <a
  href="../Wwml/index.html#html-format-strings">freely be mixed</a> in
  with the Wwml inside a w:Html tag.
  </p>
 
  <p>The callbacks file defines what actually happens when the user
  does something, e.g. clicks on the "go" button. When this happen, a
  callback function is called in this file. This callback can modify
  the user interface "live" - there is no explicit session handling as
  in e.g. PHP or JavaBeans, but it works much the same as <a
  href="http://gtk.org/">Gtk</a> - the UI stays the same until
  explicitly modified, and changes are seen by the user more or less
  directly (as soon as the webpage finnishes loading :).</p>


  <blockquote><pre>
# -*- coding: UTF-8 -*-
# vim: set fileencoding=UTF-8 :

class MyWindow(object):
    class body(object):
	class go(object):
  </pre></blockquote>

  <p>The layout of the classes defined inside each other in the
  callbacks file exactly mirrors the widget tags in the Wwml file.
  Compare the above to the following exerpt:</p>

  <blockquote><pre>
 &lt;w:HtmlWindow id="MyWindow"&gt;
  &lt;w:Html id="body"&gt;
    &lt;w:Button id="go" title="go" /&gt;
  </pre></blockquote>

  <blockquote><pre>
	    def clicked(self, path):
  </pre></blockquote>

  <p>There are several callbacks that can be defined, and the
  available callbacks varies from widget to widget. Every callback
  takes a different set of parameters, but they all share the first
  parameter - <tt>path</tt>, which is the path through the widget tree
  to the widget who's callback is called.</p>

  <blockquote><pre>
		self.parent['res'].html = self.parent['str'].value
  </pre></blockquote>

  <p>This sets the HTML code of the <tt>res</tt> child widget of the
  parent widget of the <tt>Button</tt> widget to the string the user
  has entered in the <tt>str</tt> child input widget of the parent
  widget.</p>

  <p>So, if you have managed to read this far, and have a working
  first application, it's time to read up on what widgets there are in
  the <a href="../ReferenceManual">reference manual</A> and start
  breaking your first app :P</p>

 </body>
</html>
